<html><head><title>Fields Common to Output Record Types</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" type="text/css" title="pod_stylesheet" href="style.css">

</head>
<body class='pod'>
<!--
  generated by EPICS::PodHtml v,
  using Pod::Simple::PullParser v3.35,
  under Perl v5.028001 at Tue Jul 28 14:38:58 2020 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to EPICS::PodHtml, and/or subclassing EPICS::PodHtml,
   then reconverting this document from the Pod source.
   When in doubt, email the author of EPICS::PodHtml for advice.
   See 'perldoc EPICS::PodHtml' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>

<h1><a class='u'
name="Fields-Common-to-Output-Record-Types"
>Fields Common to Output Record Types</a></h1>

<p>This section describes fields that are found in many output record types.
These fields usually have the same meaning whenever they are used.</p>

<p>See also <a href="dbCommonRecord.html" class="podlinkpod"
>Fields Common to All Record Types</a> and <a href="dbCommonInput.html" class="podlinkpod"
>Fields Common to Input Records</a>.</p>

<h3><a class='u'
name="Output-and-Value-Fields"
>Output and Value Fields</a></h3>

<p>The <b>OUT</b> field specifies an output link.
It is used by the device support routines to decide where to send output.
For soft records,
it can be a constant,
a database link,
or a channel access link.
If the link is a constant,
the result is no output.</p>

<p>The <b>DTYP</b> field specifies the name of the device support module that will input values.
Each record type has its own set of device support routines.
If a record type does not have any associated device support,
DTYP is meaningless.</p>

<p>The <b>VAL</b> field contains the desired value before any conversions to raw output have been performed.</p>

<p>The <b>OVAL</b> field is used to decide when to invoke monitors.
Archive and value change monitors are invoked if OVAL is not equal to VAL.
If a record type needs to make adjustments,
OVAL is used to enforce the maximum rate of change limit before converting the desired value to a raw value.</p>

<p>The <b>RVAL</b> field contains - whenever possible - the actual value sent to the hardware itself or to the associated device driver.</p>

<p>The <b>RBV</b> field contains - whenever possible - the actual read back value obtained from the hardware itself or from the associated device driver.</p>

<h3><a class='u'
name="Device-Support-for-Soft-Records"
>Device Support for Soft Records</a></h3>

<p>Normally two soft output device support modules are provided,
Soft Channel and and Raw Soft Channel.
Both write a value through the output link OUT.
The Soft Channel module writes output from the value associated with OVAL or VAL (if OVAL does not exist).
The Raw Soft Channel support module writes the value associated with the RVAL field after conversion has been performed.</p>

<p>The device support write routine normally calls <code>dbPutLink()</code> which writes a value through the OUT link,
and returns the status from that call.</p>

<h3><a class='u'
name="Input-and-Mode-Select-Fields"
>Input and Mode Select Fields</a></h3>

<p>The <b>DOL</b> field is a link from which the desired output value can be fetched.
DOL can be a constant,
a database link,
or a channel access link.
If DOL is a database or channel access link and OMSL is closed_loop,
then VAL is obtained from DOL.</p>

<p>The <b>OMSL</b> field selects the output mode.
This field has either the value <code>supervisory</code> or <code>closed_loop</code>.
DOL is used to fetch VAL only if OMSL has the value <code>closed_loop</code>.
By setting this field a record can be switched between supervisory and closed loop mode of operation.
While in closed loop mode,
the VAL field cannot be set via dbPuts.</p>

<h3><a class='u'
name="Output-Mode-Selection"
>Output Mode Selection</a></h3>

<p>The fields DOL and OMSL are used to allow the output record to be part of a closed loop control algorithm.
OMSL is meaningful only if DOL refers to a database or channel access link.
It can have the values <code>supervisory</code> or <code>closed_loop</code>.
If the mode is <code>supervisory</code>,
then nothing is done to VAL.
If the mode is <code>closed_loop</code> and the record type does not contain an OIF field,
then each time the record is processed,
VAL is set equal to the value obtained from the location referenced by DOL.
If the mode is <code>closed_loop</code> in record types with an OIF field and OIF is Full,
VAL is set equal to the value obtained from the location referenced by DOL; if OIF is Incremental VAL is incremented by the value obtained from DOL.</p>

<h3><a class='u'
name="Invalid-Output-Action-Fields"
>Invalid Output Action Fields</a></h3>

<p>The <b>IVOA</b> field specifies the output action for the case that the record is put into an INVALID alarm severity.
IVOA can be one of the following actions:</p>

<ul>
<li><code>Continue normally</code></li>

<li><code>Don&#39;t drive outputs</code></li>

<li><code>Set output to IVOV</code></li>
</ul>

<p>The <b>IVOV</b> field contains the value for the IVOA action <code>Set output to IVOV</code> in engineering units.
If a new severity has been set to INVALID and IVOA is <code>Set output to IVOV</code>,
then VAL is set to IVOV and converted to RVAL before device support is called.</p>

<h3><a class='u'
name="Invalid-Alarm-Output-Action"
>Invalid Alarm Output Action</a></h3>

<p>Whenever an output record is put into INVALID alarm severity,
IVOA specifies an action to take.
The record support process routine for each output record contains code which performs the following steps.</p>

<ul>
<li>If new severity is less than INVALID,
then call <code>writeValue()</code>:</li>

<li>Else do the following:
<ul>
<li>If IVOA is <code>Continue normally</code> then call <code>writeValue()</code>.</li>

<li>If IVOA is <code>Don&#39;t drive outputs</code> then do not write output.</li>

<li>If IVOA is <code>Set output to IVOV</code> then set VAL to IVOV,
call <code>convert()</code> if necessary,
and then call <code>writeValue()</code>.</li>

<li>If IVOA not one of the above,
an error message is generated.</li>
</ul>
</li>
</ul>

<h3><a class='u'
name="Output-Simulation-Fields"
>Output Simulation Fields</a></h3>

<p>The <b>SIMM</b> field controls simulation mode.
It has either the value YES or NO.
By setting this field to YES,
the record can be switched into simulation mode of operation.
While in simulation mode,
output will be forwarded through SIOL instead of OUT.</p>

<p>The <b>SIML</b> field specifies the simulation mode location.
This field can be a constant,
a database link,
or a channel access link.
If SIML is a database or channel access link,
then SIMM is read from SIML.
If SIML is a constant link then SIMM is initialized with the constant value,
but can be changed via database or channel access puts.</p>

<p>The <b>SIOL</b> field is a link that the output value is written to when the record is in simulation mode.</p>

<p>The <b>SIMS</b> field specifies the simulation mode alarm severity.
When this field is set to a value other than NO_ALARM and the record is in simulation mode,
it will be put into alarm with this severity and a status of SIMM_ALARM.</p>

<p>The <b>SDLY</b> field specifies a delay (in seconds) to implement asynchronous processing in simulation mode.
A positive SDLY value will be used as delay between the first and second phase of processing in simulation mode.
A negative value (default) specifies synchronous processing.</p>

<p>The <b>SSCN</b> field specifies the SCAN mechanism to be used in simulation mode.
This is specifically useful for &#39;I/O Intr&#39; scanned records,
which would otherwise never be scanned in simulation mode.</p>

<h3><a class='u'
name="Simulation-Mode-for-Output-Records"
>Simulation Mode for Output Records</a></h3>

<p>An output record can be switched into simulation mode of operation by setting the value of SIMM to YES.
During simulation,
the record will be put into alarm with a severity of SIMS and a status of SIMM_ALARM.
While in simulation mode,
output values,
in engineering units,
will be written to SIOL instead of OUT.
However,
the output values are never converted.
Also,
while the record is in simulation mode,
there will be no calls to device support during record processing.</p>

<p>Normally output records contain a private <code>writeValue()</code> routine which performs the following steps:</p>

<ul>
<li>If PACT is TRUE,
the device support write routine is called,
status is set to its return code,
and readValue returns.</li>

<li>Call <code>dbGetLink()</code> to get a new value for SIMM if SIML is a DB_LINK or a CA_LINK.</li>

<li>Check value of SIMM.</li>

<li>If SIMM is NO,
then call the device support write routine,
set status to its return code,
and return.</li>

<li>If SIMM is YES,
then
<ul>
<li>Set alarm status to SIMM_ALARM and severity to SIMS,
if SIMS is greater than zero.</li>

<li>If the record simulation processing is synchronous (SDLY &#60; 0) or the record is in the second phase of an asynchronous processing,
call <code>dbPutLink()</code> to write the output value from VAL or OVAL to SIOL.
<p>Otherwise (record is in first phase of an asynchronous processing),
set up a callback processing with the delay specified in SDLY.</p>
</li>

<li>Set status to the return code from <code>dbPutLink()</code> and return.</li>
</ul>
</li>

<li>If SIMM is not YES or NO,
a SOFT alarm with a severity of INVALID is raised,
and return status is set to -1.</li>
</ul>

<!-- end doc -->

</body></html>
