<html><head><title>Multi-Bit Binary Output Record (mbbo)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
<link rel="stylesheet" type="text/css" title="pod_stylesheet" href="style.css">

</head>
<body class='pod'>
<!--
  generated by EPICS::PodHtml v,
  using Pod::Simple::PullParser v3.35,
  under Perl v5.028001 at Tue Jul 28 14:39:17 2020 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to EPICS::PodHtml, and/or subclassing EPICS::PodHtml,
   then reconverting this document from the Pod source.
   When in doubt, email the author of EPICS::PodHtml for advice.
   See 'perldoc EPICS::PodHtml' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>
<div class="pod">


<h1><a class='u'
name="Multi-Bit-Binary-Output-Record-(mbbo)"
>Multi-Bit Binary Output Record (mbbo)</a></h1>

<p>The normal use for the mbbo record type is to send a binary value (representing one of up to 16 states) to a Digital Output module.
It is used for any device that uses more than one contiguous bit to control it.
The mbbo record can also be used to write discrete values to other records via database or channel access links.</p>

<h2><a class='u'
name="Parameter-Fields"
>Parameter Fields</a></h2>

<p>The record-specific fields are described below,
grouped by functionality.</p>

<h3><a class='u'
name="Scan-Parameters"
>Scan Parameters</a></h3>

<p>The mbbo record has the standard fields for specifying under what circumstances it will be processed.
These fields are listed in <a href="dbCommonRecord.html#Scan-Fields" class="podlinkpod"
>Scan Fields</a>.</p>

<h3><a class='u'
name="Desired-Output-Parameters"
>Desired Output Parameters</a></h3>

<p>The multi-bit binary output record,
like all output records,
must specify where its output originates.
The output mode select (OMSL) field determines whether the output originates from another record or from database access (i.e.,
the operator).
When set to <code>closed_loop</code>,
the desired output is retrieved from the link specified in the desired output (DOL) field--which can specify either a database or channel access link--and placed into the VAL field.
When set to <code>supervisory</code>,
the DOL field is ignored and the current value of VAL is simply written.
VAL can be changed via dpPuts at run-time when OMSL is <code>supervisory</code>.
The DOL field can also be a constant,
in which case the VAL field is initialized to the constant value.
If DOL is a constant,
OMSL cannot be set to <code>closed_loop</code>.</p>

<p>The VAL field itself usually consists of an index that specifies one of the states.
The actual output written is the value of RVAL,
which is converted from VAL following the routine explained in the next section.
However,
records that use the <code>Soft Channel</code> device support module write the VAL field&#39;s value without any conversion.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">OMSL</td><td class="cell">Output Mode Select</td><td class="cell">MENU (<a href='menuOmsl.html'>menuOmsl</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">DOL</td><td class="cell">Desired Output Loc</td><td class="cell">INLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">VAL</td><td class="cell">Desired Value</td><td class="cell">ENUM</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

</table></blockquote>


<h3><a class='u'
name="Convert-and-Write-Parameters"
>Convert and Write Parameters</a></h3>

<p>The device support routines write the desired output to the location specified in the OUT field.
If the record uses soft device support,
OUT can contain a constant,
a database link,
or a channel access link; however,
if OUT is a constant,
no value will be written.</p>

<p>For records that write their values to hardware devices,
the OUT output link must specify the address of the I/O card,
and the DTYP field must specify the corresponding device support module.
Be aware that the address format differs according to the I/O bus used.</p>

<p>For mbbo records that write to hardware,
the value written to the output location is the value contained in RVAL,
which is converted from VAL,
VAL containing an index of one of the 16 states (0-15).
RVAL is then set to the corresponding state value,
the value in one of the fields ZRVL through FFVL.
Then this value is shifted left according to the number in the SHFT field so that the value is in the correct position for the bits being used (the SHFT value is set by device support and is not configurable by the user).</p>

<p>The state value fields ZRVL through FFVL must be configured by the user before run-time.
When the state values are not defined,
the states defined (SDEF) field is set to FALSE at initialization time by the record routines.
When SDEF is FALSE,
then the record processing routine does not try to find a match,
RVAL is set equal to VAL,
the bits are shifted using the number in SHFT,
and the value is written thus.</p>

<p>If the OUT output link specifies a database link,
channel access link,
or constant,
then the DTYP field must specify either one of the two soft device support modules-- <code>Soft Channel</code> or <code>Raw Soft Channel</code>.
<code>Soft</code> <code>Channel</code> writes the value of VAL to the output link,
without any conversion,
while <code>Raw Soft Channel</code> writes the value from RVAL after it has undergone the above conversion.</p>

<p>Note also that when a string is retrieved as the desired output,
a record support routine is provided (<code>put_enum_str()</code>) that will check to see if the string matches one of the strings in the ZRST through FFST fields.
If a match is found,
RVAL is set equal to the corresponding state value of that string.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">OUT</td><td class="cell">Output Specification</td><td class="cell">OUTLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">DTYP</td><td class="cell">Device Type</td><td class="cell">DEVICE</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">RVAL</td><td class="cell">Raw Value</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">SHFT</td><td class="cell">Shift</td><td class="cell">USHORT</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SDEF</td><td class="cell">States Defined</td><td class="cell">SHORT</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">ZRVL</td><td class="cell">Zero Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">ONVL</td><td class="cell">One Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TWVL</td><td class="cell">Two Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">THVL</td><td class="cell">Three Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FRVL</td><td class="cell">Four Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FVVL</td><td class="cell">Five Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">SXVL</td><td class="cell">Six Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">SVVL</td><td class="cell">Seven Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">EIVL</td><td class="cell">Eight Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">NIVL</td><td class="cell">Nine Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TEVL</td><td class="cell">Ten Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">ELVL</td><td class="cell">Eleven Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TVVL</td><td class="cell">Twelve Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TTVL</td><td class="cell">Thirteen Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FTVL</td><td class="cell">Fourteen Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FFVL</td><td class="cell">Fifteen Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

</table></blockquote>


<h3><a class='u'
name="Operator-Display-Parameters"
>Operator Display Parameters</a></h3>

<p>These parameters are used to present meaningful data to the operator.
These fields are used to display the value and other parameters of the mbbo record either textually or graphically.
The ZRST-FFST fields contain strings describing each of the corresponding states.
The <code>get_enum_str()</code> and <code>get_enum_strs()</code> record routines retrieve these strings for the operator.
<code>get_enum_str()</code> gets the string corresponding to the value in VAL,
and <code>get_enum_strs()</code> retrieves all the strings.</p>

<p>See <a href="dbCommonRecord.html#Operator-Display-Parameters" class="podlinkpod"
>Fields Common to All Record Types</a> for more on the record name (NAME) and description (DESC) fields.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">NAME</td><td class="cell">Record Name</td><td class="cell">STRING [61]</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">DESC</td><td class="cell">Descriptor</td><td class="cell">STRING [41]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">ZRST</td><td class="cell">Zero String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">ONST</td><td class="cell">One String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TWST</td><td class="cell">Two String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">THST</td><td class="cell">Three String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FRST</td><td class="cell">Four String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FVST</td><td class="cell">Five String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">SXST</td><td class="cell">Six String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">SVST</td><td class="cell">Seven String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">EIST</td><td class="cell">Eight String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">NIST</td><td class="cell">Nine String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TEST</td><td class="cell">Ten String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">ELST</td><td class="cell">Eleven String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TVST</td><td class="cell">Twelve String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TTST</td><td class="cell">Thirteen String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FTST</td><td class="cell">Fourteen String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FFST</td><td class="cell">Fifteen String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

</table></blockquote>


<h3><a class='u'
name="Alarm-Parameters"
>Alarm Parameters</a></h3>

<p>The possible alarm conditions for multi-bit binary outputs are the SCAN,
READ,
INVALID,
and state alarms.
The SCAN and READ alarms are called by the support modules and are not configurable by the user,
as their severity is always MAJOR.</p>

<p>The IVOA field specifies an action to take from a number of possible choices when the INVALID alarm is triggered.
The IVOV field contains a value to be written once the INVALID alarm has been triggered if <code>Set output to IVOV</code> has been chosen in the IVOA field.
The severity of the INVALID alarm is not configurable by the user.</p>

<p>The state alarms are configured in the below severity fields.
These fields have the usual possible values for severity fields: NO_ALARM,
MINOR,
and MAJOR.</p>

<p>The unknown state severity field (UNSV),
if set to MINOR or MAJOR,
triggers an alarm when the record support routine cannot find a matching value in the state value fields for VAL or when VAL is out of range.</p>

<p>The change of state severity field (COSV) triggers an alarm when the record&#39;s state changes,
if set to MAJOR or MINOR.</p>

<p>The state severity (ZRSV-FFSV) fields,
when set to MAJOR or MINOR,
trigger an alarm when VAL equals the corresponding field.</p>

<p>See <a href="dbCommonOutput.html#Invalid-Output-Action-Fields" class="podlinkpod"
>Invalid Output Action Fields</a> for an explanation of the IVOA and IVOV fields.
<a href="dbCommonRecord.html#Alarm-Fields" class="podlinkpod"
>Alarm Fields</a> lists the fields related to alarms that are common to all record types.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">UNSV</td><td class="cell">Unknown State Sevr</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">COSV</td><td class="cell">Change of State Sevr</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">IVOA</td><td class="cell">INVALID outpt action</td><td class="cell">MENU (<a href='menuIvoa.html'>menuIvoa</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">IVOV</td><td class="cell">INVALID output value</td><td class="cell">USHORT</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">ZRSV</td><td class="cell">State Zero Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">ONSV</td><td class="cell">State One Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TWSV</td><td class="cell">State Two Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">THSV</td><td class="cell">State Three Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FRSV</td><td class="cell">State Four Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FVSV</td><td class="cell">State Five Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">SXSV</td><td class="cell">State Six Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">SVSV</td><td class="cell">State Seven Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">EISV</td><td class="cell">State Eight Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">NISV</td><td class="cell">State Nine Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TESV</td><td class="cell">State Ten Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">ELSV</td><td class="cell">State Eleven Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TVSV</td><td class="cell">State Twelve Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TTSV</td><td class="cell">State Thirteen Sevr</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FTSV</td><td class="cell">State Fourteen Sevr</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FFSV</td><td class="cell">State Fifteen Sevr</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

</table></blockquote>


<h3><a class='u'
name="Run-Time-Parameters"
>Run-Time Parameters</a></h3>

<p>These parameters are used by the run-time code for processing the multi-bit binary output.</p>

<p>MASK is used by device support routine to read the hardware register.
Record support sets low order of MASK the number of bits specified in NOBT.
Device support can shift this value.</p>

<p>The LALM field implements the change of state alarm severity by holding the value of VAL when the previous change of state alarm was issued.</p>

<p>MLST holds the value when the last monitor for value change was triggered.</p>

<p>SDEF is used by record support to save time if no states are defined; it is used for converting VAL to RVAL.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">NOBT</td><td class="cell">Number of Bits</td><td class="cell">USHORT</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">ORAW</td><td class="cell">Prev Raw Value</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">MASK</td><td class="cell">Hardware Mask</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">LALM</td><td class="cell">Last Value Alarmed</td><td class="cell">USHORT</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">MLST</td><td class="cell">Last Value Monitored</td><td class="cell">USHORT</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">SDEF</td><td class="cell">States Defined</td><td class="cell">SHORT</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

</table></blockquote>


<h3><a class='u'
name="Simulation-Mode-Parameters"
>Simulation Mode Parameters</a></h3>

<p>The following fields are used to operate the record in simulation mode.</p>

<p>If SIMM (fetched through SIML) is YES,
the record is put in SIMS severity and the value is written through SIOL,
without conversion.
SSCN sets a different SCAN mechanism to use in simulation mode.
SDLY sets a delay (in sec) that is used for asynchronous simulation processing.</p>

<p>See <a href="dbCommonOutput.html#Output-Simulation-Fields" class="podlinkpod"
>Output Simulation Fields</a> for more information on simulation mode and its fields.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">SIML</td><td class="cell">Simulation Mode Link</td><td class="cell">INLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SIMM</td><td class="cell">Simulation Mode</td><td class="cell">MENU (<a href='menuYesNo.html'>menuYesNo</a>)</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SIOL</td><td class="cell">Simulation Output Link</td><td class="cell">OUTLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SIMS</td><td class="cell">Simulation Mode Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SDLY</td><td class="cell">Sim. Mode Async Delay</td><td class="cell">DOUBLE</td><td class="cell">Yes</td><td class="cell">-1.0</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SSCN</td><td class="cell">Sim. Mode Scan</td><td class="cell">MENU (<a href='menuScan.html'>menuScan</a>)</td><td class="cell">Yes</td><td class="cell">65535</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

</table></blockquote>


<h2><a class='u'
name="Record-Support"
>Record Support</a></h2>

<h3><a class='u'
name="Record-Support-Routines"
>Record Support Routines</a></h3>

<h4><a class='u'
name="init_record"
>init_record</a></h4>

<p>This routine initializes SIMM if SIML is a constant or creates a channel access link if SIML is PV_LINK.
If SIOL is PV_LINK a channel access link is created.</p>

<p>This routine next checks to see that device support is available.
The routine next checks to see if the device support write routine is defined.
If either device support or the device support write routine does not exist,
an error message is issued and processing is terminated.</p>

<p>If DOL is a constant,
then VAL is initialized to its value and UDF is set to FALSE.</p>

<p>MASK is cleared and then the NOBT low order bits are set.</p>

<p>If device support includes <code>init_record()</code>,
it is called.</p>

<p>init_common is then called to determine if any states are defined.
If states are defined,
SDEF is set to TRUE.</p>

<p>If device support returns success,
VAL is then set from RVAL and UDF is set to FALSE.</p>

<h4><a class='u'
name="process"
>process</a></h4>

<p>See next section.</p>

<h4><a class='u'
name="special"
>special</a></h4>

<p>Computes SDEF when any of the fields ZRVL,...FFVL change value.</p>

<h4><a class='u'
name="get_value"
>get_value</a></h4>

<p>Fills in the values of struct valueDes so that they refer to VAL.</p>

<h4><a class='u'
name="get_enum_str"
>get_enum_str</a></h4>

<p>Retrieves ASCII string corresponding to VAL.</p>

<h4><a class='u'
name="get_enum_strs"
>get_enum_strs</a></h4>

<p>Retrieves ASCII strings for ZRST,...FFST.</p>

<h4><a class='u'
name="put_enum_str"
>put_enum_str</a></h4>

<p>Checks if string matches ZRST,...FFST and if it does,
sets VAL.</p>

<h3><a class='u'
name="Record-Processing"
>Record Processing</a></h3>

<p>Routine process implements the following algorithm:</p>

<ol>
<li>Check to see that the appropriate device support module exists.
If it doesn&#39;t,
an error message is issued and processing is terminated with the PACT field still set to TRUE.
This ensures that processes will not longer be called for this record.
Thus error storms will not occur.</li>

<li>If PACT is FALSE
<ul>
<li>If DOL is DB_LINK and OMSL is CLOSED_LOOP
<ul>
<li>Get value from DOL</li>

<li>Set UDF to FALSE</li>

<li>Check for link alarm</li>
</ul>
</li>

<li>If any state values are defined
<ul>
<li>If VAL &#62; 15,
then raise alarm and go to 4</li>

<li>Else using VAL as index set RVAL = one of ZRVL,...FFVL</li>
</ul>
</li>

<li>Else set RVAL = VAL</li>

<li>Shift RVAL left SHFT bits</li>
</ul>
</li>

<li>Convert
<ul>
<li>If PACT is FALSE,
compute RVAL
<ul>
<li>If VAL is 0,...,15,
set RVAL from ZRVL,...,FFVL</li>

<li>If VAL out of range,
set RVAL = undefined</li>
</ul>
</li>

<li>Status = write_mbbo</li>
</ul>
</li>

<li>Check alarms.
This routine checks to see if the new VAL causes the alarm status and severity to change.
If so,
NSEV,
NSTA and LALM are set.</li>

<li>Check severity and write the new value.
See <a href="dbCommonOutput.html#Output-Simulation-Fields" class="podlinkpod"
>Output Simulation Fields</a> and <a href="dbCommonOutput.html#Invalid-Output-Action-Fields" class="podlinkpod"
>Invalid Output Action Fields</a> for more information.</li>

<li>If PACT has been changed to TRUE,
the device support write output routine has started but has not completed writing the new value.
In this case,
the processing routine merely returns,
leaving PACT TRUE.</li>

<li>Check to see if monitors should be invoked.
<ul>
<li>Alarm monitors are invoked if the alarm status or severity has changed.</li>

<li>Archive and value change monitors are invoked if MLST is not equal to VAL.</li>

<li>Monitors for RVAL and RBV are checked whenever other monitors are invoked.</li>

<li>NSEV and NSTA are reset to 0.</li>
</ul>
</li>

<li>Scan forward link if necessary,
set PACT FALSE,
and return.</li>
</ol>

<h2><a class='u'
name="Device-Support"
>Device Support</a></h2>

<h3><a class='u'
name="Fields-Of-Interest-To-Device-Support"
>Fields Of Interest To Device Support</a></h3>

<p>Each mbbo record must have an associated set of device support routines.
The primary responsibility of the device support routines is to obtain a new raw mbbo value whenever write_mbbo is called.
The device support routines are primarily interested in the following fields:</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">PACT</td><td class="cell">Record active</td><td class="cell">UCHAR</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">DPVT</td><td class="cell">Device Private</td><td class="cell">NOACCESS</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">No</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">NSEV</td><td class="cell">New Alarm Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">NSTA</td><td class="cell">New Alarm Status</td><td class="cell">MENU (<a href='menuAlarmStat.html'>menuAlarmStat</a>)</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">NOBT</td><td class="cell">Number of Bits</td><td class="cell">USHORT</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">OUT</td><td class="cell">Output Specification</td><td class="cell">OUTLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">RVAL</td><td class="cell">Raw Value</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">RBV</td><td class="cell">Readback Value</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">MASK</td><td class="cell">Hardware Mask</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">SHFT</td><td class="cell">Shift</td><td class="cell">USHORT</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

</table></blockquote>


<h3><a class='u'
name="Device-Support-Routines"
>Device Support Routines</a></h3>

<p>Device support consists of the following routines:</p>

<h4><a class='u'
name="long-report(int-level)"
>long report(int level)</a></h4>

<p>This optional routine is called by the IOC command <code>dbior</code> and is passed the report level that was requested by the user.
It should print a report on the state of the device support to stdout.
The <code>level</code> parameter may be used to output increasingly more detailed information at higher levels,
or to select different types of information with different levels.
Level zero should print no more than a small summary.</p>

<h4><a class='u'
name="long-init(int-after)"
>long init(int after)</a></h4>

<p>This optional routine is called twice at IOC initialization time.
The first call happens before any of the <code>init_record()</code> calls are made,
with the integer parameter <code>after</code> set to 0.
The second call happens after all of the <code>init_record()</code> calls have been made,
with <code>after</code> set to 1.</p>

<h4><a class='u'
name="init_record"
>init_record</a></h4>

<pre>  init_record(precord)</pre>

<p>This routine is optional. If provided, it is called by the record support&#39;s <code>init_record()</code> routine. If MASK is used, it should be shifted if necessary and SHFT given a value.</p>

<h4><a class='u'
name="get_ioint_info"
>get_ioint_info</a></h4>

<pre>  get_ioint_info(int cmd,struct dbCommon *precord,IOSCANPVT *ppvt)</pre>

<p>This routine is called by the ioEventScan system each time the record is added or deleted from an I/O event scan list. <code>cmd</code> has the value (0,1) if the record is being (added to, deleted from) an I/O event list. It must be provided for any device type that can use the ioEvent scanner.</p>

<h4><a class='u'
name="write_mbbo"
>write_mbbo</a></h4>

<pre>  write_mbbo(precord)</pre>

<p>This routine must output a new value. It returns the following values:</p>

<ul>
<li>0: Success.</li>

<li>Other: Error.</li>
</ul>

<h3><a class='u'
name="Device-Support-For-Soft-Records"
>Device Support For Soft Records</a></h3>

<h4><a class='u'
name="Soft-Channel"
>Soft Channel</a></h4>

<p>The <code>Soft Channel</code> module writes the current value of VAL.</p>

<p>If the OUT link type is PV_LINK, then dbCaAddInlink is called by <code>init_record()</code>.</p>

<p><code>write_mbbo()</code> calls <code>dbPutLink()</code> to write the current value of VAL. See <a href="#Soft-Output" class="podlinkpod"
>&#34;Soft Output&#34;</a> for more information.</p>

<h4><a class='u'
name="Raw-Soft-Channel"
>Raw Soft Channel</a></h4>

<p>This module writes RVAL to the location specified in the output link. It returns a 0.</p>
</div>


<!-- end doc -->

</body></html>
